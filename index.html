<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Calculadora do Terreno</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 1.5rem; background: #f4f4f4; }
    .card { background: #fff; padding: 1.2rem; margin-bottom: 1rem; border-radius: 10px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
    label { font-size: .9rem; display: block; margin-bottom: .2rem; }
    input { width: 100%; padding: .4rem; font-size: .95rem; box-sizing: border-box; }
    .result-row { display: flex; justify-content: space-between; margin: .25rem 0; }
    .result-value { font-weight: 600; }
    .warning { background: #fff3cd; padding: .5rem; border-radius: 5px; margin-top: .5rem; font-size: .85rem; }
    .total-display { background: #e9ecef; padding: .5rem; border-radius: 5px; margin-top: .5rem; text-align: center; font-weight: 600; }
    .info { background: #e7f3ff; padding: .5rem; border-radius: 5px; margin-bottom: .5rem; font-size: .85rem; }
    
    #login { 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: #f4f4f4; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      z-index: 9999;
    }
    #login .card { 
      max-width: 300px; 
      text-align: center; 
    }
    #login input { 
      margin: 1rem 0; 
    }
    #login button { 
      width: 100%; 
      padding: .6rem; 
      background: #007bff; 
      color: white; 
      border: none; 
      border-radius: 5px; 
      cursor: pointer; 
      font-size: .95rem;
    }
    #login button:hover { 
      background: #0056b3; 
    }
    .error { 
      color: #dc3545; 
      font-size: .85rem; 
      margin-top: .5rem; 
    }
    #content { 
      display: none; 
    }
  </style>
</head>
<body>
  <div id="login">
    <div class="card">
      <h2>Acesso Restrito</h2>
      <input type="password" id="password" placeholder="Digite a senha">
      <button onclick="checkPassword()">Entrar</button>
      <div id="error" class="error"></div>
    </div>
  </div>

  <div id="content">
    <h1>Calculadora do Terreno</h1>
    <div class="card">
      <h2>Dados</h2>
      <div class="grid">
        <div><label>Valor total do terreno (R$)</label><input id="totalValue" type="number" value="15000000"></div>
        <div><label>% do valor total da área que vamos ficar</label><input id="keepPercent" type="number" step="0.01" value="10"></div>
        <div><label>Taxa advogado (%)</label><input id="lawyerFee" type="number" step="0.01" value="1.5"></div>
        <div><label>ITCMD RJ (%)</label><input id="itcmd" type="number" step="0.01" value="8"></div>
      </div>
    </div>
    
    <div class="card">
      <h2>Percentuais da herança (fixos)</h2>
      <div class="info">B: 33.33% | A: 5.55% | V: 5.55% | T: 5.55%</div>
    </div>
    
    <div class="card">
      <h2>Percentuais do terreno que vamos ficar</h2>
      <div class="grid">
        <div><label>B (%)</label><input id="BLand" type="number" step="0.01" value="40"></div>
        <div><label>A (%)</label><input id="ALand" type="number" step="0.01" value="20"></div>
        <div><label>V (%)</label><input id="VLand" type="number" step="0.01" value="20"></div>
        <div><label>T (%)</label><input id="TLand" type="number" step="0.01" value="20"></div>
      </div>
      <div class="total-display" id="totalPercent">Total: 100%</div>
      <div class="warning" id="warning" style="display:none;">⚠️ A soma dos percentuais não é 100%</div>
    </div>
    
    <div class="card">
      <h2>Resultados</h2>
      <div id="results"></div>
    </div>
  </div>

<script>
function checkPassword() {
  const pwd = document.getElementById('password').value;
  const error = document.getElementById('error');
  
  if (pwd === 'salgadofilho') {
    document.getElementById('login').style.display = 'none';
    document.getElementById('content').style.display = 'block';
    calc();
  } else {
    error.textContent = 'Senha incorreta';
  }
}

document.getElementById('password').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') checkPassword();
});

const fmt = v => new Intl.NumberFormat("pt-BR", {style:"currency",currency:"BRL"}).format(v);
const ids = ["totalValue","keepPercent","lawyerFee","itcmd","BLand","ALand","VLand","TLand"];
const inp = ids.reduce((o,id) => (o[id]=document.getElementById(id),o), {});

const inherit = {B: 33.33, A: 5.55, V: 5.55, T: 5.55};

function calc(){
  const t = +inp.totalValue.value || 0;
  const k = +inp.keepPercent.value || 0;
  const lawyerPct = +inp.lawyerFee.value || 0;
  const itcmdPct = +inp.itcmd.value || 0;
  
  const kept = t * k / 100;
  const sale = t - kept;
  
  const cousins = sale / 2 ;
  const ourTotal = sale / 2;
  
  const lawyerCost = ourTotal * (lawyerPct / 100);
  const itcmdCost = ourTotal * (itcmdPct / 100);
  const totalFees = lawyerCost + itcmdCost;
  
  const landSplits = {
    B: +inp.BLand.value, 
    A: +inp.ALand.value, 
    V: +inp.VLand.value, 
    T: +inp.TLand.value
  };
  
  const totalLand = Object.values(landSplits).reduce((sum,v) => sum+v, 0);
  const rounded = Math.round(totalLand * 100) / 100;
  totalPercent.textContent = `Total: ${rounded}%`;
  warning.style.display = Math.abs(rounded - 100) > 0.01 ? 'block' : 'none';
  
  results.innerHTML = `
    <div class='result-row'><div>Valor total:</div><div class='result-value'>${fmt(t)}</div></div>
    <div class='result-row'><div>Valor da venda:</div><div class='result-value'>${fmt(sale)}</div></div>
    <div class='result-row'><div>Valor da área que vamos ficar:</div><div class='result-value'>${fmt(kept)}</div></div>
    <hr>
    <div class='result-row'><div>Primas (50% da venda + metade da área que vamos ficar):</div><div class='result-value'>${fmt(cousins + kept/2) }</div></div>
    <div class='result-row'><div>Nossa parte (50% da venda - metade da área que vamos ficar):</div><div class='result-value'>${fmt(ourTotal - kept/2)}</div></div>
    <hr>
    <div class='result-row'><div>Advogado (${lawyerPct}%):</div><div class='result-value'>${fmt(lawyerCost)}</div></div>
    <div class='result-row'><div>ITCMD (${itcmdPct}%):</div><div class='result-value'>${fmt(itcmdCost)}</div></div>
    <div class='result-row'><div><strong>Total de taxas:</strong></div><div class='result-value'><strong>${fmt(totalFees)}</strong></div></div>
    <hr>` + 
    Object.entries(landSplits).map(([n,landPct])=>{
      const name = n.charAt(0).toUpperCase()+n.slice(1);
      const cashFromInherit = sale * (inherit[n]/100);
      const landValue = kept * (landPct/100);
      const fees = cashFromInherit * ((lawyerPct + itcmdPct) / 100);
      const finalCash = cashFromInherit - landValue - fees;
      return `
        <div style="margin-top:.8rem"><strong>${name}</strong></div>
        <div class='result-row'><div>• Dinheiro da herança (${inherit[n]}%):</div><div class='result-value'>${fmt(cashFromInherit)}</div></div>
        <div class='result-row'><div>• Valor do terreno (${landPct}%):</div><div class='result-value'>${fmt(landValue)}</div></div>
        <div class='result-row'><div>• Taxas (${lawyerPct + itcmdPct}%):</div><div class='result-value'>${fmt(fees)}</div></div>
        <div class='result-row'><div>• <strong>Total em dinheiro:</strong></div><div class='result-value'><strong>${fmt(finalCash)}</strong></div></div>`;
    }).join('');
}

ids.forEach(id => inp[id].addEventListener("input", calc));
</script>
</body>
</html>